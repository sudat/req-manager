# チェックリスト更新プラン：変更要求機能整備

## 目的
Phase 1-4 の進捗状況を調査し、完了している項目にチェックをつける。

## 調査結果

### 完了項目（チェックをつける）

#### Phase 1: PRD設計更新 - すべて完了
```markdown
- [x] 1.1.1「受入条件の確認状態」セクションを修正
- [x] 北極星KPIの定義を明確化（変更要求単位での判定を強調）
- [x] 2.7 用語定義に「受入条件確認」を追加
- [x] 4.2.1 変更要求セクションに「受入条件確認状態の追跡」機能を詳細化
- [x] PRDの「ベースライン仕様」と「変更要求」の分離原則が一貫している
- [x] 北極星KPIの判定フローが明確である
```

#### Phase 2: データベーススキーマ - マイグレーションファイル作成完了
```markdown
# テーブル作成は完了（DB適用待ち）
- [x] マイグレーションファイルを作成済み
```

#### Phase 3: ドメイン層 - すべて完了
```markdown
# 確認項目
- [x] 型定義がPRDの設計と一致している
- [x] TypeScriptビルドが成功する
- [x] 型定義がDBスキーマと一致している
- [x] 影響範囲の種別がDBスキーマと一致している
- [x] ステータスの3状態がDBスキーマと一致している
```

#### Phase 4: データアクセス層 - 関数実装完了
```markdown
# 確認項目
- [x] TypeScriptビルドが成功する
```

### 未完了・保留項目（そのまま）

#### Phase 2: DB適用待ち
```markdown
- [ ] 既存データの移行スクリプト作成（確認状態データは別テーブルへ退避）
- [ ] テーブルが正しく作成される（`supabase db push` 後）
- [ ] RLSポリシーが適用されている
- [ ] 外部キー制約が正しく機能する（`supabase db push` 後）
- [ ] 影響範囲の種別が適切に分類できる
- [ ] 同一変更要求内で受入条件IDが重複しない（`supabase db push` 後）
- [ ] 確認状態の履歴が追跡できる
```

#### Phase 3: 整合性確認 - 調査完了
```markdown
- [x] 既存の `Ticket` 型との整合性を確認（移行 or 置換の判断）

# 調査結果
- Ticket と ChangeRequest は同一概念（変更要求チケット）
- Ticket.id (CR-001) = ChangeRequest.ticketId に相当
- 一覧・詳細ページは既に ChangeRequest 型を使用
- 編集ページ・フォームフックの移行が必要
- 結論: 置換（移行）が必要
```

#### Phase 4: 動作確認待ち
```markdown
- [ ] CRUD操作が正常に動作する（動作確認待ち）
- [ ] 影響範囲の追加・削除が正常に動作する（動作確認待ち）
- [ ] 確認状態の更新が正常に動作する（動作確認待ち）
- [ ] 北極星KPI（全確認済みOK）の判定が正しく動作する（動作確認待ち）
```

## 実行内容

**ファイル**: `docs/checklists/active/2026-01-20-change-request-feature.md`

### 更新対象項目

1. **Phase 3.2**: 既存の `Ticket` 型との整合性を確認（移行 or 置換の判断）
   - チェックをつける
   - 調査結果のサマリーをコメントとして追加

2. **進捗サマリー**: 追加の調査完了項目を記載

### 更新内容詳細

```markdown
- [x] 既存の `Ticket` 型との整合性を確認（移行 or 置換の判断）
  - Ticket と ChangeRequest は同一概念（変更要求チケット）
  - 置換（移行）が必要と判断
```

## 検証方法

1. チェックリストファイルを開き、チェックが正しく適用されていることを確認
2. `bun run build` で TypeScript ビルドが成功することを確認

---

難易度: ★☆☆
根拠: 1 file, checklist updates only
リスク: なし
