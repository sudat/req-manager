# チェックリスト未完了項目の対応計画

## 調査結果サマリ

Supabase MCPで確認した結果、Phase 2〜4の未完了項目の多くは**実際には完了済み**または**対応不要**と判定。

### Phase 2: データベーススキーマ

| 項目 | 判定 | 根拠 |
|------|------|------|
| 2.1 移行スクリプト | **不要** | アプリ層で確認状態フィールドを無視する設計 |
| 2.1 既存データ保持 | **完了** | business_requirements(53行), system_requirements(56行)確認 |
| 2.2 テーブル作成 | **完了** | 3テーブル全て存在 |
| 2.2 RLSポリシー | **スキップ** | ユーザー判断: 認証なしのため不要 |
| 2.3 外部キー | **完了** | FK制約が機能 |
| 2.3 種別分類 | **完了** | CHECK制約で制限済み |
| 2.4 ユニーク制約 | **完了** | 複合ユニーク制約確認済み |
| 2.4 履歴追跡 | **完了** | created_at, updated_at存在 |

### Phase 4: データアクセス層（動作確認待ち）

| 項目 | 状態 |
|------|------|
| 4.1 CRUD動作確認 | Playwrightテスト必要 |
| 4.2 影響範囲操作 | Playwrightテスト必要 |
| 4.3 確認状態更新 | Playwrightテスト必要 |
| 4.3 北極星KPI判定 | Playwrightテスト必要 |

### Phase 5: UI実装（動作確認待ち）

| 項目 | 状態 |
|------|------|
| 5.1 受入条件入力 | Playwrightテスト必要 |

---

## 実行計画

### Step 1: チェックリスト更新
`docs/checklists/active/2026-01-20-change-request-feature.md` を更新

**完了にするチェック項目:**
- 2.1 既存の受入条件データが保持されている
- 2.2 テーブルが正しく作成される
- 2.2 RLSポリシー → 「対象外（認証なし）」と注記
- 2.3 外部キー制約が正しく機能する
- 2.3 影響範囲の種別が適切に分類できる
- 2.4 同一変更要求内で受入条件IDが重複しない
- 2.4 確認状態の履歴が追跡できる

**不要と注記するチェック項目:**
- 2.1 移行スクリプト作成 → 「不要（アプリ層で無視する設計）」

### Step 2: Playwrightによる動作確認

Playwright MCPで以下のシナリオをテスト:

**テスト1: 変更要求CRUD**
1. `http://localhost:3000/tickets/create` で新規作成
2. `http://localhost:3000/tickets` で一覧に表示されることを確認
3. 詳細ページで内容確認
4. 編集ページで更新・保存

**テスト2: 受入条件入力（確認状態なし）**
1. 業務要件編集画面で受入条件を編集
2. description と verification_method のみ入力可能なことを確認
3. status/verified_by 等のフィールドが表示されないことを確認

### Step 3: チェックリスト最終更新

テスト結果に基づき、Phase 4/5の動作確認項目を完了に更新

---

## 検証方法

1. `bun run dev` でローカルサーバー起動
2. Playwright MCPでブラウザ操作
3. Supabase MCPでDBデータ確認

---

## 対象ファイル

- `docs/checklists/active/2026-01-20-change-request-feature.md` - チェックリスト更新
